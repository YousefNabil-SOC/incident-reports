<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
<title>BROKER-001 — Yousef Nabil</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Barlow:wght@300;400;500;600&family=Barlow+Condensed:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap');

:root {

/* MOBILE RESPONSIVENESS */
@media (max-width: 768px) {
  .sidebar { width: 100%; position: relative; top: 0; border-right: none; border-bottom: 1px solid var(--border2); }
  .main { margin: 0 auto; position: relative; margin-left: 0; padding: 20px 16px 60px; }
  .layout { flex-direction: column; }
  .nav-w { --nav-w: 100%; }
  html { font-size: 16px; }
  .topbar { flex-wrap: wrap; height: auto; min-height: var(--top-h); padding: 12px 16px; }
  .tb-analyst { border-right: none; padding-right: 0; margin-bottom: 8px; }
}
  --bg:        #1a1d26;
  --bg2:       #22262f;
  --surface:   #2a2f3c;
  --surface2:  #323948;
  --border:    rgba(255,200,80,0.07);
  --border2:   rgba(255,200,80,0.14);
  --border3:   rgba(255,200,80,0.25);
  --amber:     #f0a500;
  --amber-dim: rgba(240,165,0,0.10);
  --amber-glow:rgba(240,165,0,0.04);
  --red:       #e84040;
  --red-dim:   rgba(232,64,64,0.12);
  --green:     #2ecc71;
  --green-dim: rgba(46,204,113,0.10);
  --blue:      #4a9eff;
  --blue-dim:  rgba(74,158,255,0.10);
  --purple:    #a78bfa;
  --purple-dim:rgba(167,139,250,0.10);
  --text:      #e8eaf2;
  --text2:     #b5bcc8;
  --text3:     #7a8090;
  --mono:      'JetBrains Mono', monospace;
  --cond:      'Barlow Condensed', sans-serif;
  --sans:      'Barlow', sans-serif;
  --nav-w:     228px;
  --top-h:     48px;
  --radius:    4px;
}

*,*::before,*::after { box-sizing:border-box; margin:0; padding:0; }
html { font-size:18px; scroll-behavior:smooth; }

body {
  font-family:var(--sans);
  background:var(--bg);
  color:var(--text);
  line-height:1.6;
  -webkit-font-smoothing:antialiased;
}

body::before {
  content:'';
  position:fixed; inset:0; z-index:0; pointer-events:none;
  background-image:radial-gradient(circle, rgba(255,200,80,0.055) 1px, transparent 1px);
  background-size:28px 28px;
}

/* ── TOPBAR ── */
.topbar {
  position:fixed; top:0; left:0; right:0; z-index:200;
  height:var(--top-h);
  background:rgba(8,10,13,0.97);
  border-bottom:1px solid var(--border2);
  backdrop-filter:blur(12px);
  display:flex; align-items:center;
  padding:0 24px; gap:16px;
}
.tb-analyst {
  display:flex; flex-direction:column; gap:1px;
  border-right:1px solid var(--border2);
  padding-right:16px;
}
.tb-name { font-family:var(--cond); font-size:15px; font-weight:700; color:var(--text); letter-spacing:.3px; }
.tb-role { font-family:var(--mono); font-size:8.5px; font-weight:400; letter-spacing:1.8px; text-transform:uppercase; color:var(--text3); }
.tb-mid  { flex:1; display:flex; align-items:center; gap:20px; }
.tb-id   { font-family:var(--mono); font-size:11px; color:var(--text3); letter-spacing:.5px; }
.tb-title { font-family:var(--cond); font-size:14.5px; font-weight:500; color:var(--text2); letter-spacing:.3px; flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.sev { font-family:var(--mono); font-size:9px; font-weight:600; letter-spacing:2px; text-transform:uppercase; padding:3px 10px; border-radius:2px; }
.sev-critical { background:var(--red); color:#fff; }
.sev-high     { background:#8a4800; color:#f0a500; border:1px solid var(--amber); }

/* ── LAYOUT ── */
.layout { display:flex; justify-content: center; padding-top:var(--top-h); position:relative; z-index:1; }

/* ── SIDEBAR ── */
.sidebar {
  width:var(--nav-w); flex-shrink:0;
  position:fixed; top:var(--top-h); bottom:0; left:0;
  background:var(--bg2);
  border-right:1px solid var(--border2);
  overflow-y:auto; padding:20px 0 40px;
  scrollbar-width:thin; scrollbar-color:var(--border2) transparent;
}
.nav-section-label { font-family:var(--mono); font-size:8px; font-weight:500; letter-spacing:2.5px; text-transform:uppercase; color:var(--text3); padding:0 18px 8px; }
.nav-group-label { font-family:var(--mono); font-size:7.5px; font-weight:500; letter-spacing:2px; text-transform:uppercase; color:var(--text3); opacity:.5; padding:10px 18px 4px; }
.nav-link {
  display:flex; align-items:center; gap:10px;
  padding:6px 18px; text-decoration:none;
  color:var(--text3); font-size:11.5px; font-weight:400;
  font-family:var(--sans);
  border-left:2px solid transparent;
  transition:all .12s ease; cursor:pointer;
}
.nav-link:hover { color:var(--text2); background:var(--amber-glow); }
.nav-link.active { color:var(--amber); border-left-color:var(--amber); background:var(--amber-dim); font-weight:500; }
.nav-idx { font-family:var(--mono); font-size:9px; color:var(--text3); min-width:18px; }
.nav-link.active .nav-idx { color:var(--amber); opacity:.6; }

/* ── MAIN ── */
.main { margin: 0 auto; position: relative; margin-left:var(--nav-w); flex:1; min-width:0; padding:40px 70px 100px 70px; max-width: 1400px; width: 92%; margin: 0 auto; }

/* ── COVER ── */
.cover {
  background:var(--surface);
  border:1px solid var(--border2);
  border-top:3px solid var(--amber);
  border-radius:var(--radius);
  padding:36px 40px;
  margin-bottom:28px;
  position:relative; overflow:hidden;
}
.cover::after {
  content:''; position:absolute; top:0; right:0;
  width:260px; height:260px;
  background:radial-gradient(circle at top right, rgba(240,165,0,0.07) 0%, transparent 70%);
  pointer-events:none;
}
.cover::before {
  content:'BROKER'; position:absolute; right:30px; bottom:20px;
  font-family:var(--cond); font-size:90px; font-weight:700;
  color:rgba(240,165,0,0.04); letter-spacing:4px;
  pointer-events:none; user-select:none;
}
.cover-eyebrow { font-family:var(--mono); font-size:9px; font-weight:500; letter-spacing:3px; text-transform:uppercase; color:var(--amber); opacity:.7; margin-bottom:10px; }
.cover-title { font-family:var(--cond); font-size:30px; font-weight:700; color:var(--text); line-height:1.15; margin-bottom:4px; letter-spacing:.3px; }
.cover-sub { font-size:14.5px; color:var(--text2); margin-bottom:26px; letter-spacing:.3px; }
.meta-row { display:grid; grid-template-columns:repeat(auto-fill, minmax(160px, 1fr)); gap:6px; }
.meta-item { background:rgba(0,0,0,.3); border:1px solid var(--border); border-radius:var(--radius); padding:8px 11px; }
.meta-key { font-family:var(--mono); font-size:8.5px; font-weight:500; letter-spacing:1.5px; text-transform:uppercase; color:var(--text3); margin-bottom:3px; }
.meta-val { font-size:14.5px; font-weight:500; color:var(--text); }
.meta-val.crit { color:#fca5a5; }
.meta-val.high { color:var(--amber); }
.meta-val.green { color:var(--green); }

/* ── ATTACK FLOW ── */
.attack-flow { display:flex; align-items:center; gap:0; margin:14px 0; flex-wrap:wrap; }
.af-step {
  display:flex; flex-direction:column; align-items:center;
  background:var(--surface2); border:1px solid var(--border2);
  border-radius:var(--radius); padding:8px 12px;
  min-width:90px; text-align:center;
}
.af-num { font-family:var(--mono); font-size:8px; color:var(--amber); opacity:.6; margin-bottom:3px; }
.af-name { font-family:var(--cond); font-size:11px; font-weight:600; color:var(--text2); letter-spacing:.5px; }
.af-arrow { color:var(--text3); font-size:16px; padding:0 4px; align-self:center; }
.af-step.active { border-color:var(--amber); background:var(--amber-dim); }
.af-step.active .af-name { color:var(--amber); }

/* ── SECTION ── */
.section { margin-bottom:2px; scroll-margin-top:calc(var(--top-h) + 16px); }
.section-header { display:flex; align-items:center; gap:10px; padding:14px 0 10px; border-bottom:1px solid var(--border2); margin-bottom:16px; }
.sh-num { font-family:var(--mono); font-size:9px; font-weight:600; color:var(--amber); opacity:.5; min-width:24px; }
.sh-title { font-family:var(--cond); font-size:14.5px; font-weight:700; letter-spacing:2.5px; text-transform:uppercase; color:var(--text2); }
.sh-mitre { font-family:var(--mono); font-size:9px; color:var(--blue); opacity:.7; margin-left:auto; white-space:nowrap; }
.section-body { padding-bottom:24px; }

/* ── SUBSECTION ── */
.sub { margin:14px 0 10px; }
.sub-label { font-family:var(--mono); font-size:9px; font-weight:500; letter-spacing:1.8px; text-transform:uppercase; color:var(--amber); opacity:.65; padding-bottom:6px; margin-bottom:8px; border-bottom:1px solid var(--border); }

/* ── PROSE ── */
.p { font-size:14.5px; line-height:1.75; color:var(--text2); margin-bottom:10px; }
.p strong { color:var(--text); font-weight:600; }
.p + .p { margin-top:-4px; }

/* ── TABLE ── */
.tbl-outer { overflow-x:auto; margin:8px 0 14px; border-radius:var(--radius); border:1px solid var(--border2); }
table { width:100%; border-collapse:collapse; font-size:15.5px; }
thead tr { background:rgba(240,165,0,0.06); }
thead th { font-family:var(--mono); font-size:8.5px; font-weight:500; letter-spacing:1.2px; text-transform:uppercase; color:var(--amber); opacity:.8; padding:9px 13px; text-align:left; border-bottom:1px solid var(--border2); white-space:nowrap; }
tbody tr { border-bottom:1px solid var(--border); }
tbody tr:last-child { border-bottom:none; }
tbody tr:hover td { background:var(--amber-glow); }
td { padding:7px 13px; color:var(--text2); vertical-align:top; line-height:1.5; }

/* ── LIST ── */
.bl { list-style:none; border:1px solid var(--border); border-radius:var(--radius); margin:6px 0; }
.bl li { display:flex; align-items:flex-start; gap:9px; padding:8px 14px 8px 12px; font-size:14.5px; color:var(--text2); border-bottom:1px solid var(--border); border-left:2px solid transparent; line-height:1.55; transition:all .1s ease; flex-wrap:wrap; }
.bl li:last-child { border-bottom:none; }
.bl li::before { content:'›'; color:var(--amber); opacity:.5; font-size:15px; line-height:1.3; flex-shrink:0; margin-top:-1px; }
.bl li:hover { background:var(--amber-glow); border-left-color:rgba(240,165,0,.2); }
.bl strong { color:var(--text); font-weight:600; }

/* ── TIMELINE ── */
.tl { padding-left:20px; position:relative; margin:8px 0; }
.tl::before { content:''; position:absolute; left:5px; top:6px; bottom:6px; width:1px; background:linear-gradient(to bottom, var(--amber), transparent); opacity:.3; }
.tl-row { display:flex; gap:16px; padding:7px 0; position:relative; }
.tl-row::before { content:''; position:absolute; left:-17px; top:13px; width:7px; height:7px; border-radius:50%; background:var(--bg2); border:1.5px solid var(--amber); opacity:.6; }
.tl-row.crit::before { border-color:var(--red); }
.tl-t { font-family:var(--mono); font-size:10.5px; font-weight:500; color:var(--amber); opacity:.8; min-width:136px; flex-shrink:0; padding-top:1px; }
.tl-row.crit .tl-t { color:var(--red); opacity:.9; }
.tl-e { font-size:14.5px; color:var(--text2); flex:1; line-height:1.5; }
.tl-e strong { color:var(--text); }
.tl-device { font-family:var(--mono); font-size:9px; padding:1px 6px; border-radius:2px; margin-left:6px; vertical-align:middle; }
.td-pc1 { background:rgba(74,158,255,.12); color:var(--blue); border:1px solid rgba(74,158,255,.2); }
.td-pc2 { background:rgba(167,139,250,.12); color:var(--purple); border:1px solid rgba(167,139,250,.2); }
.td-srv { background:rgba(46,204,113,.12); color:var(--green); border:1px solid rgba(46,204,113,.2); }

/* ── FINDING BOX ── */
.finding {
  background:var(--surface);
  border:1px solid var(--border2);
  border-left:3px solid var(--amber);
  border-radius:var(--radius);
  padding:12px 16px;
  margin:10px 0;
}
.finding-label { font-family:var(--mono); font-size:8px; font-weight:600; letter-spacing:2px; text-transform:uppercase; color:var(--amber); opacity:.6; margin-bottom:6px; }
.finding-val { font-family:var(--mono); font-size:15.5px; color:var(--text); word-break:break-all; }
.finding.red   { border-left-color:var(--red); }
.finding.red .finding-label { color:var(--red); }
.finding.blue  { border-left-color:var(--blue); }
.finding.blue .finding-label { color:var(--blue); }
.finding.green { border-left-color:var(--green); }
.finding.green .finding-label { color:var(--green); }

/* ── FLAGS ROW ── */
.flags-grid { display:grid; grid-template-columns:repeat(auto-fill, minmax(200px, 1fr)); gap:8px; margin:10px 0; }
.flag-card { background:var(--surface2); border:1px solid var(--border2); border-radius:var(--radius); padding:10px 13px; }
.flag-q { font-family:var(--mono); font-size:8px; font-weight:500; letter-spacing:1.5px; text-transform:uppercase; color:var(--text3); margin-bottom:4px; }
.flag-a { font-family:var(--mono); font-size:11.5px; color:var(--amber); word-break:break-all; }
.flag-a.sm { font-size:9.5px; }

/* ── KQL ── */
.kql { margin:12px 0; }
.kql-hd { font-size:11px; color:var(--text2); margin-bottom:5px; padding-left:1px; }
.kql-hd b { font-family:var(--mono); font-size:10.5px; color:var(--amber); font-weight:600; opacity:.9; }
.kql-wrap { background:#05080d; border:1px solid rgba(240,165,0,0.15); border-radius:var(--radius); }
.kql-bar { background:rgba(240,165,0,0.05); border-bottom:1px solid rgba(240,165,0,0.1); padding:5px 13px; display:flex; align-items:center; gap:8px; }
.kql-dots { display:flex; gap:4px; }
.kql-dots i { width:7px; height:7px; border-radius:50%; background:var(--border2); }
.kql-tag { font-family:var(--mono); font-size:8px; font-weight:600; letter-spacing:2px; text-transform:uppercase; color:var(--amber); opacity:.5; }
.kql-wrap pre { font-family:var(--mono); font-size:11.5px; color:#b3c3e0; line-height:1.7; padding:12px 14px; overflow-x:auto; tab-size:2; }

/* ── IMPACT ── */
.impact-wrap { border:1px solid var(--border); border-radius:var(--radius); margin:6px 0; background:var(--surface); }
.impact-row { display:flex; align-items:flex-start; gap:10px; padding:9px 13px; border-bottom:1px solid var(--border); border-left:2px solid transparent; font-size:14.5px; color:var(--text2); line-height:1.5; }
.impact-row:last-child { border-bottom:none; }
.impact-row.conf { border-left-color:var(--red); }
.impact-row.risk { border-left-color:var(--amber); }
.impact-row.pers { border-left-color:var(--purple); }
.ibadge { font-family:var(--mono); font-size:8px; font-weight:700; letter-spacing:1.2px; text-transform:uppercase; padding:2px 6px; border-radius:2px; white-space:nowrap; margin-top:2px; flex-shrink:0; }
.ibadge.conf { background:var(--red-dim); color:var(--red); }
.ibadge.risk { background:var(--amber-dim); color:var(--amber); }
.ibadge.pers { background:var(--purple-dim); color:var(--purple); }
.impact-row strong { color:var(--text); }

/* ── RISK BANNER ── */
.risk { display:flex; align-items:flex-start; gap:12px; padding:11px 14px; border-radius:var(--radius); border:1px solid; margin:10px 0; font-size:14.5px; line-height:1.55; }
.risk.critical { background:var(--red-dim); border-color:rgba(232,64,64,.25); color:var(--text2); }
.risk.high     { background:var(--amber-dim); border-color:rgba(240,165,0,.25); color:var(--text2); }
.risk-lbl { font-family:var(--mono); font-size:9px; font-weight:700; letter-spacing:2px; text-transform:uppercase; white-space:nowrap; margin-top:2px; flex-shrink:0; }
.risk.critical .risk-lbl { color:var(--red); }
.risk.high .risk-lbl     { color:var(--amber); }
.risk strong { color:var(--text); }

/* ── RECS ── */
.rec-grp { margin:10px 0; }
.rec-badge { display:inline-flex; font-family:var(--mono); font-size:8.5px; font-weight:700; letter-spacing:1.5px; text-transform:uppercase; padding:3px 9px; border-radius:2px; margin-bottom:6px; }
.rb-now   { background:var(--red-dim); color:var(--red); }
.rb-short { background:var(--amber-dim); color:var(--amber); }
.rb-long  { background:var(--green-dim); color:var(--green); }

/* ── IOC BADGE ── */
.ioc { display:inline-block; font-family:var(--mono); font-size:10px; background:rgba(74,158,255,.08); color:var(--blue); border:1px solid rgba(74,158,255,.18); border-radius:2px; padding:1px 6px; margin:1px 2px; word-break:break-all; }
.ioc.hash { background:rgba(167,139,250,.08); color:var(--purple); border-color:rgba(167,139,250,.18); }
.ioc.ip   { background:rgba(46,204,113,.08); color:var(--green); border-color:rgba(46,204,113,.18); }
.ioc.red  { background:var(--red-dim); color:var(--red); border-color:rgba(232,64,64,.2); }

/* ── PHASE TAG ── */
.phase-tag { display:inline-flex; align-items:center; font-family:var(--mono); font-size:9px; font-weight:600; letter-spacing:1px; text-transform:uppercase; color:var(--text2); background:var(--surface2); border:1px solid var(--border2); border-radius:2px; padding:3px 9px; margin:3px 3px 6px 0; }

/* ── FOOTER ── */
.foot { margin-top:24px; padding-top:18px; border-top:1px solid var(--border); display:flex; justify-content:space-between; align-items:center; font-family:var(--mono); font-size:9.5px; color:var(--text3); }
.foot-conf { color:var(--red); opacity:.5; font-weight:700; letter-spacing:2px; }

code { font-family:var(--mono); font-size:11px; color:#93c5fd; background:rgba(74,158,255,0.1); padding:1px 5px; border-radius:2px; word-break:break-all; overflow-wrap:anywhere; }

::-webkit-scrollbar { width:5px; height:5px; }
::-webkit-scrollbar-track { background:transparent; }
::-webkit-scrollbar-thumb { background:var(--border2); border-radius:3px; }
</style>
</head>
<body>

<nav class="topbar">
  <div class="tb-analyst">
    <span class="tb-name">Yousef Nabil</span>
    <span class="tb-role">Incident Response Analyst</span>
  </div>
  <div class="tb-mid">
    <span class="tb-id">BROKER-001</span>
    <span class="tb-title">Ashford Sterling Recruitment — Initial Access Broker Intrusion</span>
    <span class="sev sev-critical">CRITICAL</span>
  </div>
</nav>

<div class="layout">
<aside class="sidebar">
  <div class="nav-section-label">Navigation</div>
  <a class="nav-link" href="#summary"><span class="nav-idx">00</span>Executive Summary</a>
  <a class="nav-link" href="#who"><span class="nav-idx">01</span>WHO</a>
  <a class="nav-link" href="#what"><span class="nav-idx">02</span>WHAT</a>
  <a class="nav-link" href="#when"><span class="nav-idx">03</span>WHEN</a>
  <a class="nav-link" href="#where"><span class="nav-idx">04</span>WHERE</a>
  <a class="nav-link" href="#how"><span class="nav-idx">05</span>HOW</a>
  <div class="nav-group-label">Attack Phases</div>
  <a class="nav-link" href="#s1"><span class="nav-idx">S1</span>Initial Access</a>
  <a class="nav-link" href="#s2"><span class="nav-idx">S2</span>Command &amp; Control</a>
  <a class="nav-link" href="#s3"><span class="nav-idx">S3</span>Credential Access</a>
  <a class="nav-link" href="#s4"><span class="nav-idx">S4</span>Discovery</a>
  <a class="nav-link" href="#s5"><span class="nav-idx">S5</span>Remote Tool Deploy</a>
  <a class="nav-link" href="#s6"><span class="nav-idx">S6</span>Lateral Movement</a>
  <a class="nav-link" href="#s7"><span class="nav-idx">S7</span>Scheduled Task</a>
  <a class="nav-link" href="#s8"><span class="nav-idx">S8</span>Data Access</a>
  <a class="nav-link" href="#s9"><span class="nav-idx">S9</span>Anti-Forensics</a>
  <div class="nav-group-label">Analysis</div>
  <a class="nav-link" href="#impact"><span class="nav-idx">10</span>Impact</a>
  <a class="nav-link" href="#intel"><span class="nav-idx">11</span>Threat Intel</a>
  <a class="nav-link" href="#ioc"><span class="nav-idx">12</span>IOC Summary</a>
  <a class="nav-link" href="#recs"><span class="nav-idx">13</span>Recommendations</a>
  <a class="nav-link" href="#kql"><span class="nav-idx">14</span>KQL Queries</a>
</aside>

<main class="main">

<!-- COVER -->
<div class="cover">
  <div class="cover-eyebrow">Incident Response Report</div>
  <div class="cover-title">Ashford Sterling Recruitment<br><span style="font-weight:300;font-size:.6em;color:var(--text2)">Initial Access Broker — Full-Chain Intrusion</span></div>
  <div class="cover-sub">BROKER-001 &nbsp;·&nbsp; Attack Date: 2026-01-15</div>
  <div class="meta-row">
<div class="meta-item">
  <div class="meta-key">ESCALATED TO</div>
  <div class="meta-val">Josh — Cyber Range Community</div>
</div>
    <div class="meta-item"><div class="meta-key">Incident ID</div><div class="meta-val">BROKER-001</div></div>
    <div class="meta-item"><div class="meta-key">Report Date</div><div class="meta-val">February 25, 2026</div></div>
    <div class="meta-item"><div class="meta-key">Severity</div><div class="meta-val crit">CRITICAL</div></div>
    <div class="meta-item"><div class="meta-key">Status</div><div class="meta-val green">Complete</div></div>
    <div class="meta-item"><div class="meta-key">Analyst</div><div class="meta-val">Yousef Nabil</div></div>
    <div class="meta-item"><div class="meta-key">Platform</div><div class="meta-val">MDE + Sentinel</div></div>
    <div class="meta-item"><div class="meta-key">Attack Date</div><div class="meta-val high">2026-01-15</div></div>
    <div class="meta-item"><div class="meta-key">Dwell Time</div><div class="meta-val high">~4 hours observed</div></div>
    <div class="meta-item"><div class="meta-key">Devices Compromised</div><div class="meta-val crit">AS-PC1, AS-PC2, AS-SRV</div></div>
    <div class="meta-item"><div class="meta-key">Threat Classification</div><div class="meta-val crit">Initial Access Broker</div></div>
  </div>
</div>

<!-- ATTACK FLOW -->
<div style="margin-bottom:28px;">
  <div style="font-family:var(--mono);font-size:8.5px;letter-spacing:2px;text-transform:uppercase;color:var(--text3);margin-bottom:10px;">Attack Chain Overview</div>
  <div class="attack-flow">
    <div class="af-step active"><div class="af-num">T1566</div><div class="af-name">Phishing</div></div>
    <div class="af-arrow">→</div>
    <div class="af-step active"><div class="af-num">T1059</div><div class="af-name">Execution</div></div>
    <div class="af-arrow">→</div>
    <div class="af-step active"><div class="af-num">T1071</div><div class="af-name">C2</div></div>
    <div class="af-arrow">→</div>
    <div class="af-step active"><div class="af-num">T1003</div><div class="af-name">Cred Dump</div></div>
    <div class="af-arrow">→</div>
    <div class="af-step active"><div class="af-num">T1021</div><div class="af-name">Lat. Move</div></div>
    <div class="af-arrow">→</div>
    <div class="af-step active"><div class="af-num">T1053</div><div class="af-name">Persist</div></div>
    <div class="af-arrow">→</div>
    <div class="af-step active"><div class="af-num">T1005</div><div class="af-name">Data Access</div></div>
    <div class="af-arrow">→</div>
    <div class="af-step active"><div class="af-num">T1070</div><div class="af-name">Anti-Forensics</div></div>
  </div>
</div>

<!-- SECTION 00: EXECUTIVE SUMMARY -->
<div class="section" id="summary">
<div class="section-header">
  <span class="sh-num">00</span>
  <span class="sh-title">Executive Summary</span>
</div>
<div class="section-body">
<p class="p">On <strong>January 15, 2026</strong>, Ashford Sterling Recruitment suffered a sophisticated full-chain intrusion consistent with Initial Access Broker (IAB) tradecraft. The compromise began when a user on <strong>AS-PC1</strong> (Sophie.Turner) executed a malicious file masquerading as a recruitment CV — <code>Daniel_Richardson_CV.pdf.exe</code> — downloaded from the company network. The file used the double-extension technique (T1036.007) to deceive the user into believing it was a PDF document.</p>
<p class="p">Once executed, the malware established Command &amp; Control communications to <code>cdn.cloud-endpoint.net</code> and began systematic enumeration of the environment. The threat actor proceeded through credential access (registry hive dumping of SAM and SYSTEM), network discovery, and lateral movement across all three company devices — pivoting from AS-PC1 to AS-PC2 then to AS-SRV. The attacker deployed AnyDesk remote access tool on all three machines using certutil as a download proxy, configured an unattended-access password, and established scheduled task persistence on both AS-PC2 and AS-SRV under the masqueraded binary <code>RuntimeBroker.exe</code>.</p>
<p class="p">On AS-SRV, the actor accessed the <code>C:\Shares\Payroll\</code> directory, opened <code>BACS_Payments_Dec2025.ods</code> (a BACS payment file containing banking details), and created an archive <code>Shares.7z</code> packaging the share contents for exfiltration. In-memory credential theft was conducted via SharpChrome reflectively loaded into notepad.exe, targeting saved browser passwords from both Microsoft Edge and Google Chrome via DPAPI decryption. Event logs were cleared on completion to degrade forensic visibility. All evidence was reconstructed from Microsoft Defender for Endpoint telemetry in Microsoft Sentinel.</p>
<div class="risk critical">
  <span class="risk-lbl">Critical</span>
  <span><strong>Full-chain IAB compromise confirmed.</strong> The attacker achieved persistent access on three hosts, dumped NTLM-crackable registry hives, accessed payroll banking data (BACS), stole browser-stored credentials via SharpChrome/DPAPI, and packaged share data for exfiltration — all within a ~4-hour window before clearing logs.</span>
</div>
</div>
</div>

<!-- SECTION 01: WHO -->
<div class="section" id="who">
<div class="section-header">
  <span class="sh-num">01</span>
  <span class="sh-title">WHO</span>
</div>
<div class="section-body">
<div class="sub"><div class="sub-label">Threat Actor Classification</div>
<p class="p">The threat actor exhibits hallmarks of an <strong>Initial Access Broker (IAB)</strong> — a criminal specialist who gains entry into organizations, establishes persistent remote access, and either sells that access to ransomware operators or conducts espionage/financial fraud independently. The operational tempo (rapid tool deployment, AnyDesk persistence across all hosts, registry credential staging, payroll data access) is consistent with a financially motivated actor preparing to monetize access.</p>
</div>
<div class="sub"><div class="sub-label">Attacker Infrastructure</div>
<div class="tbl-outer"><table>
<thead><tr><th>Indicator</th><th>Role</th><th>Protocol/Port</th><th>Notes</th></tr></thead>
<tbody>
<tr><td><code>cdn.cloud-endpoint.net</code></td><td>C2 server — command &amp; control</td><td>HTTPS / 443</td><td>Malware beaconed here for instructions; blends with CDN traffic</td></tr>
<tr><td><code>sync.cloud-endpoint.net</code></td><td>Staging server — payload hosting</td><td>HTTPS / 443</td><td>certutil downloads sourced from here; RuntimeBroker.exe retrieved</td></tr>
<tr><td><code>download.anydesk.com</code></td><td>AnyDesk official download</td><td>HTTPS / 443</td><td>Attacker used legitimate AnyDesk CDN to avoid domain-based detection</td></tr>
</tbody>
</table></div></div>
<div class="sub"><div class="sub-label">Compromised Accounts Used</div>
<div class="tbl-outer"><table>
<thead><tr><th>Account</th><th>Device</th><th>Type</th><th>Observed Usage</th></tr></thead>
<tbody>
<tr><td>Sophie.Turner</td><td>AS-PC1</td><td>Domain user (victim)</td><td>Initial vector execution; all AS-PC1 malicious activity ran under this account</td></tr>
<tr><td>david.mitchell</td><td>AS-PC2</td><td>Domain user (victim)</td><td>Pivoted to AS-PC2 via RDP (mstsc); used to enable Administrator and deploy tooling</td></tr>
<tr><td>Administrator</td><td>AS-PC2, AS-SRV</td><td>Local built-in (disabled→enabled)</td><td>Activated via <code>net user Administrator /active:yes</code>; used for WMIC/PsExec attempts</td></tr>
<tr><td>AS.SRV.Administrator</td><td>AS-SRV</td><td>Local admin</td><td>Logged in via Guacamole RDP; created Shares.7z archive</td></tr>
<tr><td>svc_backup</td><td>AS-PC1</td><td>Backdoor local account (created by attacker)</td><td>Created by malware and added to Administrators group for persistence</td></tr>
</tbody>
</table></div></div>
</div>
</div>

<!-- SECTION 02: WHAT -->
<div class="section" id="what">
<div class="section-header">
  <span class="sh-num">02</span>
  <span class="sh-title">WHAT</span>
</div>
<div class="section-body">
<ul class="bl">
  <li><strong>Initial Access:</strong> User Sophie.Turner executed <code>Daniel_Richardson_CV.pdf.exe</code> after double-clicking it from the Downloads folder — masqueraded as a recruitment CV using double-extension technique (T1036.007). Parent process: explorer.exe.</li>
  <li><strong>C2 Establishment:</strong> Malware immediately established outbound HTTPS communications to <code>cdn.cloud-endpoint.net</code> for command &amp; control beaconing.</li>
  <li><strong>Discovery:</strong> Malware executed <code>whoami.exe</code>, <code>ipconfig.exe</code>, and <code>net.exe view</code> to enumerate the victim identity, network configuration, and visible network shares. <code>net localgroup Administrators</code> was also queried.</li>
  <li><strong>Credential Access:</strong> <code>reg.exe</code> was used to dump HKLM\SAM and HKLM\SYSTEM registry hives to <code>C:\Users\Public\</code> as sam.hiv and system.hiv — enabling offline NTLM hash extraction.</li>
  <li><strong>Remote Tool Deployment:</strong> AnyDesk was downloaded via <code>certutil.exe -urlcache -split -f</code> from <code>download.anydesk.com</code> to <code>C:\Users\Public\AnyDesk.exe</code> on all three hosts. Unattended password set to <code>intrud3r!</code>.</li>
  <li><strong>Backdoor Account Creation:</strong> <code>net.exe user svc_backup [password] /add</code> followed by <code>net.exe localgroup Administrators svc_backup /add</code> — creating a persistent local admin account on AS-PC1.</li>
  <li><strong>Lateral Movement:</strong> From AS-PC1, attacker attempted WMIC (×4) and PsExec (×2) against AS-PC2 — all failed. Succeeded via <code>mstsc.exe /v:10.1.0.183</code> (RDP). From AS-PC2, WMIC (×2) against AS-SRV failed; succeeded via <code>mstsc.exe /v:10.1.0.203</code>.</li>
  <li><strong>Scheduled Task Persistence:</strong> On AS-PC2 and AS-SRV, <code>Daniel_Richardson_CV.pdf.exe</code> was downloaded via certutil and saved as <code>C:\Users\Public\RuntimeBroker.exe</code> (masquerading as a Windows system binary). A scheduled task named <strong>MicrosoftEdgeUpdateCheck</strong> was created to execute it daily at 03:00 with highest privileges.</li>
  <li><strong>Data Access:</strong> On AS-SRV, the attacker accessed <code>C:\Shares\Payroll\BACS_Payments_Dec2025.ods</code> (BACS banking payment file) — confirmed editing via LibreOffice lock file artifact. Contents of all shares were archived into <code>Shares.7z</code>.</li>
  <li><strong>In-Memory Credential Theft:</strong> SharpChrome was reflectively loaded (T1620) into <code>notepad.exe</code> — a legitimate Windows process — to steal saved passwords from Chrome and Edge via DPAPI decryption. No SharpChrome file ever appeared on disk.</li>
  <li><strong>Anti-Forensics:</strong> Four Windows event logs cleared using <code>wevtutil.exe cl</code>: Security, System, Application, Windows PowerShell. Memory region protection was also modified in notepad.exe address space.</li>
</ul>
</div>
</div>

<!-- SECTION 03: WHEN -->
<div class="section" id="when">
<div class="section-header">
  <span class="sh-num">03</span>
  <span class="sh-title">WHEN</span>
  <span class="sh-mitre">All times UTC (Sentinel)</span>
</div>
<div class="section-body">
<div class="sub"><div class="sub-label">Full Attack Timeline</div>
<div class="tl">
  <div class="tl-row"><div class="tl-t">04:28 UTC</div><div class="tl-e"><strong>Sophie.Turner RDP logon</strong> to AS-PC1 via Guacamole (IP 10.0.8.6). Explorer.exe spawned as user context. <span class="tl-device td-pc1">AS-PC1</span></div></div>
  <div class="tl-row crit"><div class="tl-t">06:31 UTC</div><div class="tl-e"><strong>Initial compromise</strong> — Sophie.Turner double-clicks <code>Daniel_Richardson_CV.pdf.exe</code> from Downloads folder. Explorer.exe spawns malware with High integrity. <span class="tl-device td-pc1">AS-PC1</span></div></div>
  <div class="tl-row"><div class="tl-t">06:31 UTC</div><div class="tl-e"><strong>C2 established</strong> — malware beacons to <code>cdn.cloud-endpoint.net</code> over HTTPS. <span class="tl-device td-pc1">AS-PC1</span></div></div>
  <div class="tl-row"><div class="tl-t">06:31 UTC</div><div class="tl-e"><strong>Discovery phase</strong> — whoami.exe, ipconfig.exe, net.exe view, net localgroup Administrators executed by malware. <span class="tl-device td-pc1">AS-PC1</span></div></div>
  <div class="tl-row"><div class="tl-t">~06:45 UTC</div><div class="tl-e"><strong>Credential staging</strong> — reg.exe dumps HKLM\SAM → C:\Users\Public\sam.hiv and HKLM\SYSTEM → C:\Users\Public\system.hiv. <span class="tl-device td-pc1">AS-PC1</span></div></div>
  <div class="tl-row"><div class="tl-t">06:48 UTC</div><div class="tl-e"><strong>David.Mitchell RDP logon</strong> to AS-PC2 via Guacamole (IP 10.0.8.5). <span class="tl-device td-pc2">AS-PC2</span></div></div>
  <div class="tl-row"><div class="tl-t">07:08 UTC</div><div class="tl-e"><strong>AnyDesk deployed on AS-PC1</strong> — certutil downloads AnyDesk.exe to C:\Users\Public\. cmd.exe launches AnyDesk. AnyDesk config read from <code>C:\Users\Sophie.Turner\AppData\Roaming\AnyDesk\system.conf</code>. <span class="tl-device td-pc1">AS-PC1</span></div></div>
  <div class="tl-row"><div class="tl-t">07:10 UTC</div><div class="tl-e"><strong>AnyDesk started</strong> — <code>cmd.exe /c "start C:\Users\Public\AnyDesk.exe"</code> <span class="tl-device td-pc1">AS-PC1</span></div></div>
  <div class="tl-row"><div class="tl-t">07:18 UTC</div><div class="tl-e"><strong>Lateral movement attempts begin</strong> — WMIC (×4) against AS-PC2 with Administrator credentials — all fail. PsExec (×2) against AS-PC2 — all fail. <span class="tl-device td-pc1">AS-PC1</span></div></div>
  <div class="tl-row"><div class="tl-t">07:29 UTC</div><div class="tl-e"><strong>RDP to AS-PC2 succeeds</strong> — <code>mstsc.exe /v:10.1.0.183</code>. Remote session initiator switches to AS-PC1 (10.1.0.154). <span class="tl-device td-pc1">AS-PC1</span> → <span class="tl-device td-pc2">AS-PC2</span></div></div>
  <div class="tl-row"><div class="tl-t">07:40 UTC</div><div class="tl-e"><strong>AS-PC2 takeover</strong> — PowerShell spawned; <code>net.exe user Administrator /active:yes</code>; AnyDesk downloaded via certutil, password set to <code>intrud3r!</code>. <span class="tl-device td-pc2">AS-PC2</span></div></div>
  <div class="tl-row"><div class="tl-t">07:42 UTC</div><div class="tl-e"><strong>Share enumeration</strong> — <code>dir \\AS-SRV\Payroll</code> executed from AS-PC2. <span class="tl-device td-pc2">AS-PC2</span></div></div>
  <div class="tl-row"><div class="tl-t">07:52 UTC</div><div class="tl-e"><strong>Scheduled task persistence on AS-PC2</strong> — certutil downloads malware as RuntimeBroker.exe; schtasks creates MicrosoftEdgeUpdateCheck. <span class="tl-device td-pc2">AS-PC2</span></div></div>
  <div class="tl-row"><div class="tl-t">07:53–07:54 UTC</div><div class="tl-e"><strong>WMIC to AS-SRV fails (×2)</strong> then <strong>mstsc to AS-SRV succeeds</strong> — <code>mstsc.exe /v:10.1.0.203</code>. <span class="tl-device td-pc2">AS-PC2</span> → <span class="tl-device td-srv">AS-SRV</span></div></div>
  <div class="tl-row"><div class="tl-t">07:56 UTC</div><div class="tl-e"><strong>AS-SRV takeover</strong> — certutil downloads RuntimeBroker.exe from sync.cloud-endpoint.net; AnyDesk downloaded; schtasks creates MicrosoftEdgeUpdateCheck. <span class="tl-device td-srv">AS-SRV</span></div></div>
  <div class="tl-row crit"><div class="tl-t">07:57 UTC</div><div class="tl-e"><strong>Backdoor account created on AS-PC1</strong> — <code>net.exe user svc_backup [pw] /add</code>; <code>net.exe localgroup Administrators svc_backup /add</code>. <span class="tl-device td-pc1">AS-PC1</span></div></div>
  <div class="tl-row crit"><div class="tl-t">~Payroll access</div><div class="tl-e"><strong>BACS_Payments_Dec2025.ods opened for editing</strong> on AS-SRV shares from AS-PC2. LibreOffice lock file created. Shares.7z archive created. <span class="tl-device td-srv">AS-SRV</span></div></div>
  <div class="tl-row"><div class="tl-t">08:07 UTC</div><div class="tl-e"><strong>Log clearing begins</strong> — wevtutil cl Security, System, Application, Windows PowerShell. <span class="tl-device td-pc1">AS-PC1</span></div></div>
  <div class="tl-row crit"><div class="tl-t">08:09 UTC</div><div class="tl-e"><strong>SharpChrome injection #1</strong> — malware injects into notepad.exe; CLR module loaded; Edge credentials decrypted via DPAPI (UnprotectData). <span class="tl-device td-pc1">AS-PC1</span></div></div>
  <div class="tl-row crit"><div class="tl-t">08:10 UTC</div><div class="tl-e"><strong>SharpChrome injection #2</strong> — second notepad.exe instance; Chrome Login Data accessed; Google Chrome credentials decrypted via DPAPI. <span class="tl-device td-pc1">AS-PC1</span></div></div>
  <div class="tl-row"><div class="tl-t">08:17 UTC</div><div class="tl-e"><strong>Memory protection manipulation</strong> — malware modifies memory region protection in notepad.exe address space (VirtualProtectEx equivalent). <span class="tl-device td-pc1">AS-PC1</span></div></div>
</div>
</div>
</div>
</div>

<!-- SECTION 04: WHERE -->
<div class="section" id="where">
<div class="section-header">
  <span class="sh-num">04</span>
  <span class="sh-title">WHERE</span>
</div>
<div class="section-body">
<div class="sub"><div class="sub-label">Compromised Hosts</div>
<div class="tbl-outer"><table>
<thead><tr><th>Hostname</th><th>IP (Attack Day)</th><th>Role</th><th>Primary User</th><th>Compromise Method</th></tr></thead>
<tbody>
<tr><td><code>AS-PC1</code></td><td>10.1.0.154</td><td>User workstation — Patient Zero</td><td>Sophie.Turner</td><td>Direct execution of malicious PDF.EXE</td></tr>
<tr><td><code>AS-PC2</code></td><td>10.1.0.183</td><td>User workstation — Pivot host</td><td>david.mitchell</td><td>RDP lateral movement from AS-PC1 (mstsc)</td></tr>
<tr><td><code>AS-SRV</code></td><td>10.1.0.203</td><td>File server — Final target</td><td>AS.SRV.Administrator</td><td>RDP lateral movement from AS-PC2 (mstsc)</td></tr>
</tbody>
</table></div></div>
<div class="sub"><div class="sub-label">Key File System Paths</div>
<div class="tbl-outer"><table>
<thead><tr><th>Path</th><th>Device</th><th>Significance</th></tr></thead>
<tbody>
<tr><td><code>C:\Users\Sophie.Turner\Downloads\Daniel_Richardson_CV\Daniel_Richardson_CV.pdf.exe</code></td><td>AS-PC1</td><td>Initial access vector — malicious executable</td></tr>
<tr><td><code>C:\Users\Public\</code></td><td>AS-PC1/PC2/SRV</td><td>Attacker staging directory — AnyDesk, sam.hiv, system.hiv stored here</td></tr>
<tr><td><code>C:\Users\Public\AnyDesk.exe</code></td><td>All three</td><td>Remote access tool deployed on all hosts</td></tr>
<tr><td><code>C:\Users\Public\RuntimeBroker.exe</code></td><td>AS-PC2, AS-SRV</td><td>Malware masquerading as Windows process for scheduled task persistence</td></tr>
<tr><td><code>C:\Users\Sophie.Turner\AppData\Roaming\AnyDesk\system.conf</code></td><td>AS-PC1</td><td>AnyDesk config file — read by attacker via cmd.exe type command</td></tr>
<tr><td><code>C:\Shares\Payroll\BACS_Payments_Dec2025.ods</code></td><td>AS-SRV</td><td>Sensitive payroll banking file — accessed and edited</td></tr>
<tr><td><code>C:\Shares\Clients\Shares.7z</code></td><td>AS-SRV</td><td>Exfiltration archive — entire share contents packaged</td></tr>
</tbody>
</table></div></div>
<div class="sub"><div class="sub-label">External Infrastructure</div>
<div class="tbl-outer"><table>
<thead><tr><th>Domain / IP</th><th>Role</th><th>Used By</th></tr></thead>
<tbody>
<tr><td><code>cdn.cloud-endpoint.net</code></td><td>C2 — command &amp; control</td><td>Daniel_Richardson_CV.pdf.exe (beaconing)</td></tr>
<tr><td><code>sync.cloud-endpoint.net</code></td><td>Staging — payload hosting</td><td>certutil.exe (payload downloads)</td></tr>
<tr><td><code>download.anydesk.com</code></td><td>AnyDesk official CDN</td><td>certutil.exe (AnyDesk downloads)</td></tr>
<tr><td>10.0.8.6</td><td>Guacamole RDP gateway IP for AS-PC1 initial logon</td><td>Sophie.Turner RDP source</td></tr>
<tr><td>10.0.8.5</td><td>Guacamole RDP gateway IP for AS-PC2 initial logon</td><td>David.Mitchell RDP source</td></tr>
</tbody>
</table></div></div>
</div>
</div>

<!-- SECTION 05: HOW -->
<div class="section" id="how">
<div class="section-header">
  <span class="sh-num">05</span>
  <span class="sh-title">HOW</span>
</div>
<div class="section-body">
<p class="p">The intrusion followed a systematic, multi-stage methodology consistent with a professional IAB operator. The attacker leveraged social engineering for initial access, a custom malware dropper for C2 and execution, legitimate Windows binaries (certutil, reg, net, schtasks, mstsc) for all subsequent actions — a LOLBIN (Living Off the Land Binaries) strategy that minimizes new file writes and evades AV detection. The full methodology is detailed in sections S1–S9 below.</p>
<div class="sub"><div class="sub-label">Key Techniques by MITRE ATT&amp;CK</div>
<div class="tbl-outer"><table>
<thead><tr><th>Technique ID</th><th>Name</th><th>Implementation Observed</th></tr></thead>
<tbody>
<tr><td>T1566.001</td><td>Spearphishing Attachment</td><td>CV-themed .exe delivered as apparent PDF</td></tr>
<tr><td>T1036.007</td><td>Double File Extension</td><td>Daniel_Richardson_CV.pdf.exe masquerading as PDF</td></tr>
<tr><td>T1071.001</td><td>Application Layer Protocol — Web</td><td>C2 over HTTPS to cdn.cloud-endpoint.net</td></tr>
<tr><td>T1003.002</td><td>Security Account Manager</td><td>reg save HKLM\SAM + HKLM\SYSTEM to Public folder</td></tr>
<tr><td>T1021.001</td><td>Remote Desktop Protocol</td><td>mstsc.exe for lateral movement PC1→PC2→SRV</td></tr>
<tr><td>T1053.005</td><td>Scheduled Task</td><td>MicrosoftEdgeUpdateCheck on PC2 and SRV</td></tr>
<tr><td>T1105</td><td>Ingress Tool Transfer</td><td>certutil -urlcache -split -f for all payload downloads</td></tr>
<tr><td>T1219</td><td>Remote Access Software</td><td>AnyDesk deployed on all 3 hosts with set-password</td></tr>
<tr><td>T1136.001</td><td>Create Local Account</td><td>svc_backup added to Administrators group on AS-PC1</td></tr>
<tr><td>T1620</td><td>Reflective Code Loading</td><td>SharpChrome loaded into notepad.exe memory — no disk artifact</td></tr>
<tr><td>T1555.003</td><td>Credentials from Web Browsers</td><td>SharpChrome + DPAPI targeting Edge and Chrome Login Data</td></tr>
<tr><td>T1005</td><td>Data from Local System</td><td>BACS_Payments_Dec2025.ods accessed; Shares.7z created</td></tr>
<tr><td>T1070.001</td><td>Clear Windows Event Logs</td><td>wevtutil cl Security/System/Application/Windows PowerShell</td></tr>
</tbody>
</table></div></div>
</div>
</div>

<!-- SECTION S1: INITIAL ACCESS -->
<div class="section" id="s1">
<div class="section-header">
  <span class="sh-num">S1</span>
  <span class="sh-title">Initial Access</span>
  <span class="sh-mitre">T1566.001 · T1036.007 · T1204.002</span>
</div>
<div class="section-body">
<p class="p">Initial access was achieved via <strong>user execution of a masqueraded executable</strong>. The file <code>Daniel_Richardson_CV.pdf.exe</code> was delivered to Sophie.Turner's Downloads folder, disguised as a recruitment CV using the double-extension technique — the .pdf prefix was designed to make the file appear as a PDF document to an untrained user. Windows hides known file extensions by default, making this deception highly effective.</p>
<p class="p">When Sophie.Turner double-clicked the file, Windows Explorer (explorer.exe) spawned it as the parent process — confirming direct user interaction. The malware ran with High integrity level and Default token elevation, meaning it ran with Sophie.Turner's full privileges. Almost immediately it spawned <code>notepad.exe ""</code> as a child process — an unusual invocation (empty argument string) that serves as a host process for code injection.</p>
<div class="flags-grid">
  <div class="flag-card"><div class="flag-q">Initial Vector</div><div class="flag-a">Daniel_Richardson_CV.pdf.exe</div></div>
  <div class="flag-card"><div class="flag-q">SHA256</div><div class="flag-a sm">48b97fd91946e81e3e7742b3554585360551551cbf9398e1f34f4bc4eac3a6b5</div></div>
  <div class="flag-card"><div class="flag-q">User Interaction Parent</div><div class="flag-a">explorer</div></div>
  <div class="flag-card"><div class="flag-q">Suspicious Child Process</div><div class="flag-a">notepad.exe</div></div>
  <div class="flag-card"><div class="flag-q">Process Arguments</div><div class="flag-a">notepad.exe ""</div></div>
</div>
<div class="sub"><div class="sub-label">How I Found It</div>
<p class="p">The initial vector was identified directly from the MDE Alert Story for AS-PC1, which showed the full process tree: userinit.exe → explorer.exe → Daniel_Richardson_CV.pdf.exe → notepad.exe. The SHA256 required a KQL query against DeviceProcessEvents since the alert story only shows SHA1.</p>
</div>
<div class="kql">
<div class="kql-hd"><b>Q-S1</b> — Confirm initial vector SHA256 and process chain</div>
<div class="kql-wrap">
  <div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceProcessEvents</span></div>
  <pre>DeviceProcessEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName == "as-pc1"
| where FileName =~ "Daniel_Richardson_CV.pdf.exe"
| project Timestamp, FileName, SHA256, FolderPath,
          InitiatingProcessFileName, ProcessCommandLine</pre>
</div></div>
</div>
</div>

<!-- SECTION S2: C2 -->
<div class="section" id="s2">
<div class="section-header">
  <span class="sh-num">S2</span>
  <span class="sh-title">Command &amp; Control</span>
  <span class="sh-mitre">T1071.001 · T1102</span>
</div>
<div class="section-body">
<p class="p">Once executed, the malware established outbound communications over HTTPS (port 443) to <code>cdn.cloud-endpoint.net</code> — the C2 server. Using HTTPS over port 443 is deliberate: this traffic is encrypted and blends into normal web browsing, making it difficult to distinguish from legitimate CDN traffic at the network layer without TLS inspection. The domain name itself (cdn.cloud-endpoint.net) is designed to appear as a legitimate cloud CDN service.</p>
<p class="p">A separate domain — <code>sync.cloud-endpoint.net</code> — served as the payload staging server. This separation of C2 and staging infrastructure is a tradecraft indicator: if the staging domain is burned (blocked), the C2 channel remains intact, and vice versa. All certutil-based payload downloads (RuntimeBroker.exe on PC2 and SRV) originated from the staging domain.</p>
<div class="flags-grid">
  <div class="flag-card"><div class="flag-q">C2 Domain</div><div class="flag-a">cdn.cloud-endpoint.net</div></div>
  <div class="flag-card"><div class="flag-q">C2 Process</div><div class="flag-a">daniel_richardson_cv.pdf.exe</div></div>
  <div class="flag-card"><div class="flag-q">Staging Domain</div><div class="flag-a">sync.cloud-endpoint.net</div></div>
</div>
<div class="kql">
<div class="kql-hd"><b>Q-S2</b> — Confirm C2 domain and outbound connections from malware</div>
<div class="kql-wrap">
  <div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceNetworkEvents</span></div>
  <pre>DeviceNetworkEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName == "as-pc1"
| where InitiatingProcessFileName =~ "Daniel_Richardson_CV.pdf.exe"
| project Timestamp, RemoteUrl, RemoteIP, RemotePort,
          InitiatingProcessFileName
| order by Timestamp asc</pre>
</div></div>
</div>
</div>

<!-- SECTION S3: CREDENTIAL ACCESS -->
<div class="section" id="s3">
<div class="section-header">
  <span class="sh-num">S3</span>
  <span class="sh-title">Credential Access</span>
  <span class="sh-mitre">T1003.002 · T1552.001</span>
</div>
<div class="section-body">
<p class="p">The attacker used <code>reg.exe</code> — a built-in Windows utility — to dump two critical registry hives from HKLM (HKEY_LOCAL_MACHINE) to disk. These two hives together are sufficient to extract all local account NTLM password hashes offline using tools like Impacket secretsdump or samdump2.</p>
<p class="p"><strong>HKLM\SAM</strong> (Security Account Manager) stores all local user account password hashes. However, the hashes inside SAM are encrypted using the system boot key. <strong>HKLM\SYSTEM</strong> contains that boot key. Without SYSTEM, SAM is useless. Together, they allow full offline NTLM hash extraction — which can then be cracked offline or used directly in Pass-the-Hash attacks without ever knowing the plaintext password. Both files were staged to <code>C:\Users\Public\</code> — a world-readable directory ideal for attacker staging due to no permission restrictions.</p>
<div class="flags-grid">
  <div class="flag-card"><div class="flag-q">Registry Targets</div><div class="flag-a">SAM,SYSTEM</div></div>
  <div class="flag-card"><div class="flag-q">Local Staging Directory</div><div class="flag-a">C:\Users\Public\</div></div>
  <div class="flag-card"><div class="flag-q">Execution Identity</div><div class="flag-a">Sophie.Turner</div></div>
</div>
<div class="kql">
<div class="kql-hd"><b>Q-S3</b> — Registry hive dumping activity</div>
<div class="kql-wrap">
  <div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceProcessEvents</span></div>
  <pre>DeviceProcessEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName == "as-pc1"
| where FileName =~ "reg.exe"
| project Timestamp, AccountName, FileName, ProcessCommandLine
| order by Timestamp asc</pre>
</div></div>
<div class="sub"><div class="sub-label">Evidence Rows</div>
<div class="tbl-outer"><table>
<thead><tr><th>Timestamp (UTC)</th><th>AccountName</th><th>Command Line</th></tr></thead>
<tbody>
<tr><td>2026-01-15T04:13:32Z</td><td>sophie.turner</td><td><code>"reg.exe" save HKLM\SAM C:\Users\Public\sam.hiv</code></td></tr>
<tr><td>2026-01-15T04:13:32Z</td><td>sophie.turner</td><td><code>"reg.exe" save HKLM\SYSTEM C:\Users\Public\system.hiv</code></td></tr>
</tbody>
</table></div></div>
</div>
</div>

<!-- SECTION S4: DISCOVERY -->
<div class="section" id="s4">
<div class="section-header">
  <span class="sh-num">S4</span>
  <span class="sh-title">Discovery</span>
  <span class="sh-mitre">T1033 · T1135 · T1069.001 · T1016</span>
</div>
<div class="section-body">
<p class="p">Immediately after execution, the malware launched a systematic environment discovery phase using native Windows utilities. This is consistent with automated post-exploitation reconnaissance scripts embedded in the malware — the commands ran within seconds of initial execution in rapid succession.</p>
<div class="flags-grid">
  <div class="flag-card"><div class="flag-q">Identity Command</div><div class="flag-a">whoami.exe</div></div>
  <div class="flag-card"><div class="flag-q">View Shares Command</div><div class="flag-a">net.exe view</div></div>
  <div class="flag-card"><div class="flag-q">Local Group Queried</div><div class="flag-a">Administrators</div></div>
</div>
<div class="sub"><div class="sub-label">Discovery Command Analysis</div>
<div class="tbl-outer"><table>
<thead><tr><th>Command</th><th>MITRE</th><th>Purpose</th><th>Attacker Use</th></tr></thead>
<tbody>
<tr><td><code>whoami.exe</code></td><td>T1033</td><td>Confirms current user identity</td><td>Verify privilege level — domain user, local admin, or SYSTEM?</td></tr>
<tr><td><code>ipconfig.exe</code></td><td>T1016</td><td>Network configuration</td><td>IP addressing, subnet, domain — maps the environment</td></tr>
<tr><td><code>net.exe view</code></td><td>T1135</td><td>Enumerates network shares</td><td>Discovered AS-SRV and its accessible shares — direct path to data</td></tr>
<tr><td><code>net localgroup Administrators</code></td><td>T1069.001</td><td>Local admin group members</td><td>Identifies high-value accounts to target or impersonate</td></tr>
</tbody>
</table></div></div>
<div class="kql">
<div class="kql-hd"><b>Q-S4</b> — Discovery commands executed by malware</div>
<div class="kql-wrap">
  <div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceProcessEvents</span></div>
  <pre>DeviceProcessEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName == "as-pc1"
| where FileName in~ ("whoami.exe","net.exe","ipconfig.exe","hostname.exe")
| project Timestamp, AccountName, FileName, ProcessCommandLine
| order by Timestamp asc</pre>
</div></div>
</div>
</div>

<!-- SECTION S5: REMOTE TOOL -->
<div class="section" id="s5">
<div class="section-header">
  <span class="sh-num">S5</span>
  <span class="sh-title">Persistence — Remote Tool (AnyDesk)</span>
  <span class="sh-mitre">T1219 · T1105 · T1552.001</span>
</div>
<div class="section-body">
<p class="p">AnyDesk is a legitimate remote desktop application widely used in enterprise environments. The attacker leveraged it as a persistent, covert remote access channel — separate from the C2 malware — meaning even if the malware is detected and removed, the attacker retains GUI-level access to all three compromised hosts through AnyDesk's unattended access feature.</p>
<p class="p"><strong>Deployment method:</strong> AnyDesk was downloaded using <code>certutil.exe -urlcache -split -f</code> — a classic LOLBIN technique abusing a built-in Windows certificate utility for file download. Certutil is not expected to make external connections in most environments, but it is rarely blocked because it has legitimate uses. The <code>-split</code> flag forces binary file writing, and <code>-urlcache</code> uses IE's URL cache mechanism.</p>
<p class="p"><strong>Unattended access password:</strong> After deployment, the attacker configured AnyDesk for unattended access using the command <code>echo intrud3r! | AnyDesk.exe --set-password</code> — piping the password directly into stdin to avoid it appearing as a visible argument in process telemetry (the password appears as asterisks in most logging). The config file was then read via <code>cmd.exe /c "type C:\Users\Sophie.Turner\AppData\Roaming\AnyDesk\system.conf"</code> to verify configuration.</p>
<div class="flags-grid">
  <div class="flag-card"><div class="flag-q">Remote Tool</div><div class="flag-a">AnyDesk</div></div>
  <div class="flag-card"><div class="flag-q">Download Binary</div><div class="flag-a">certutil.exe</div></div>
  <div class="flag-card"><div class="flag-q">Unattended Password</div><div class="flag-a">intrud3r!</div></div>
  <div class="flag-card"><div class="flag-q">Deployed Hosts</div><div class="flag-a">AS-PC1, AS-PC2, AS-SRV</div></div>
  <div class="flag-card"><div class="flag-q">Config File Accessed</div><div class="flag-a sm">C:\Users\Sophie.Turner\AppData\Roaming\AnyDesk\system.conf</div></div>
  <div class="flag-card"><div class="flag-q">AnyDesk SHA256</div><div class="flag-a sm">f42b635d93720d1624c74121b83794d706d4d064bee027650698025703d20532</div></div>
</div>
<div class="kql">
<div class="kql-hd"><b>Q-S5a</b> — AnyDesk download and file creation events</div>
<div class="kql-wrap">
  <div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceFileEvents</span></div>
  <pre>DeviceFileEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName has_any ("as-pc1","as-pc2","as-srv")
| where FileName has_any ("AnyDesk.exe","AnyDesk[1].exe")
| project Timestamp, DeviceName, ActionType, FolderPath,
          FileName, SHA256, InitiatingProcessFileName,
          InitiatingProcessCommandLine
| order by Timestamp asc</pre>
</div></div>
<div class="kql">
<div class="kql-hd"><b>Q-S5b</b> — AnyDesk config file access (honest hunting approach)</div>
<div class="kql-wrap">
  <div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceFileEvents</span></div>
  <pre>DeviceFileEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName has_any ("as-pc1","as-pc2","as-srv")
| where InitiatingProcessFileName =~ "AnyDesk.exe"
| project Timestamp, DeviceName, ActionType, FolderPath,
          FileName, InitiatingProcessAccountName
| order by Timestamp asc</pre>
</div></div>
<div class="kql">
<div class="kql-hd"><b>Q-S5c</b> — Config file read via cmd type command (how the path was confirmed)</div>
<div class="kql-wrap">
  <div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceProcessEvents</span></div>
  <pre>DeviceProcessEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName has_any ("as-pc1","as-pc2","as-srv")
| where ProcessCommandLine has ".conf"
| project Timestamp, DeviceName, AccountName, FileName,
          ProcessCommandLine
| order by Timestamp asc</pre>
</div></div>
</div>
</div>

<!-- SECTION S6: LATERAL MOVEMENT -->
<div class="section" id="s6">
<div class="section-header">
  <span class="sh-num">S6</span>
  <span class="sh-title">Lateral Movement</span>
  <span class="sh-mitre">T1021.001 · T1569.002 · T1047 · T1543</span>
</div>
<div class="section-body">
<p class="p">The attacker systematically attempted lateral movement using multiple remote execution tools before succeeding with RDP. This trial-and-error pattern — exhausting WMIC then PsExec before falling back to mstsc — is characteristic of a human operator adapting in real-time to environmental restrictions (firewall rules, disabled services, credential issues).</p>
<div class="sub"><div class="sub-label">Lateral Movement Sequence — AS-PC1 → AS-PC2</div>
<div class="tbl-outer"><table>
<thead><tr><th>Time (UTC)</th><th>Tool</th><th>Target</th><th>Command</th><th>Result</th></tr></thead>
<tbody>
<tr><td>04:18–04:23</td><td>WMIC.exe (×4)</td><td>AS-PC2</td><td><code>/node:AS-PC2 process call create certutil...</code></td><td>❌ Failed — retried 4 times</td></tr>
<tr><td>04:24–04:25</td><td>PsExec.exe (×2)</td><td>AS-PC2</td><td><code>-accepteula \\AS-PC2 -u Administrator cmd.exe</code></td><td>❌ Failed — switched tools</td></tr>
<tr><td>04:29</td><td>mstsc.exe</td><td>AS-PC2 (10.1.0.183)</td><td><code>"mstsc.exe" /v:10.1.0.183</code></td><td>✅ Success</td></tr>
</tbody>
</table></div></div>
<div class="sub"><div class="sub-label">Lateral Movement Sequence — AS-PC2 → AS-SRV</div>
<div class="tbl-outer"><table>
<thead><tr><th>Time (UTC)</th><th>Tool</th><th>Target</th><th>Command</th><th>Result</th></tr></thead>
<tbody>
<tr><td>04:53–04:54</td><td>WMIC.exe (×2)</td><td>AS-SRV (10.1.0.203)</td><td><code>/node:10.1.0.203 process call create certutil...</code></td><td>❌ Failed</td></tr>
<tr><td>04:54</td><td>mstsc.exe</td><td>AS-SRV (10.1.0.203)</td><td><code>"mstsc.exe" /v:10.1.0.203</code></td><td>✅ Success</td></tr>
</tbody>
</table></div></div>
<div class="flags-grid">
  <div class="flag-card"><div class="flag-q">Failed Tools</div><div class="flag-a">psexec.exe, wmic.exe</div></div>
  <div class="flag-card"><div class="flag-q">Failed Target Host</div><div class="flag-a">as-pc2</div></div>
  <div class="flag-card"><div class="flag-q">Successful Pivot Tool</div><div class="flag-a">mstsc.exe</div></div>
  <div class="flag-card"><div class="flag-q">Movement Path</div><div class="flag-a">AS-PC1 &gt; AS-PC2 &gt; AS-SRV</div></div>
  <div class="flag-card"><div class="flag-q">Successful Auth User</div><div class="flag-a">david.mitchell</div></div>
  <div class="flag-card"><div class="flag-q">Activation Parameter</div><div class="flag-a">/active:yes</div></div>
  <div class="flag-card"><div class="flag-q">Activation Context User</div><div class="flag-a">david.mitchell</div></div>
</div>
<div class="sub"><div class="sub-label">Why Failed Attempts Are Still Forensic Gold</div>
<p class="p">The failed WMIC and PsExec attempts are as valuable as the successful RDP pivots. They reveal the attacker's full credential set at the time — they were using the local Administrator account with a password obtained earlier. They also reveal the attacker's tooling — both WMIC and PsExec were present on AS-PC1, suggesting a prepared toolkit. Most importantly, the 4× WMIC retry pattern shows human operator behavior, not automated execution.</p>
</div>
<div class="kql">
<div class="kql-hd"><b>Q-S6</b> — All remote execution tool attempts (broad hunt — not just known tools)</div>
<div class="kql-wrap">
  <div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceProcessEvents</span></div>
  <pre>DeviceProcessEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName has_any ("as-pc1","as-pc2","as-srv")
| where FileName in~ ("psexec.exe","wmic.exe","winrs.exe","mstsc.exe",
                      "schtasks.exe","sc.exe","at.exe","net.exe")
| where ProcessCommandLine has_any ("\\\\","/node:","-s ","/s ",
                                    "/v:","computername","/r:")
| project Timestamp, DeviceName, AccountName, FileName,
          ProcessCommandLine
| order by Timestamp asc</pre>
</div></div>
</div>
</div>

<!-- SECTION S7: SCHEDULED TASK -->
<div class="section" id="s7">
<div class="section-header">
  <span class="sh-num">S7</span>
  <span class="sh-title">Persistence — Scheduled Task</span>
  <span class="sh-mitre">T1053.005 · T1036.003 · T1136.001</span>
</div>
<div class="section-body">
<p class="p">On both AS-PC2 and AS-SRV, the attacker established scheduled task persistence using the same malware binary (<code>Daniel_Richardson_CV.pdf.exe</code>) renamed to <code>RuntimeBroker.exe</code>. RuntimeBroker.exe is a legitimate Windows system process (responsible for managing permissions for apps from the Microsoft Store), making this an effective masquerade — defenders are less likely to question a process with a known-legitimate name.</p>
<p class="p">The scheduled task was named <strong>MicrosoftEdgeUpdateCheck</strong> — again chosen to blend in with legitimate Microsoft Edge update tasks that exist in enterprise environments. It was configured to run daily at 03:00 (3 AM) with highest privilege, providing the attacker with a persistent daily callback window even if the active session is terminated or the machine is rebooted.</p>
<p class="p">The SHA256 of RuntimeBroker.exe matches the original malware exactly — confirming it is the same payload, just renamed. Additionally, the backdoor account <code>svc_backup</code> was created on AS-PC1 and added to the Administrators group — providing a second persistent access path via local credentials, independent of AnyDesk or scheduled tasks.</p>
<div class="flags-grid">
  <div class="flag-card"><div class="flag-q">Task Name</div><div class="flag-a">MicrosoftEdgeUpdateCheck</div></div>
  <div class="flag-card"><div class="flag-q">Renamed Binary</div><div class="flag-a">RuntimeBroker.exe</div></div>
  <div class="flag-card"><div class="flag-q">Persistence SHA256</div><div class="flag-a sm">48b97fd91946e81e3e7742b3554585360551551cbf9398e1f34f4bc4eac3a6b5</div></div>
  <div class="flag-card"><div class="flag-q">Backdoor Account</div><div class="flag-a">svc_backup</div></div>
</div>
<div class="kql">
<div class="kql-hd"><b>Q-S7a</b> — Scheduled task creation across all devices</div>
<div class="kql-wrap">
  <div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceProcessEvents</span></div>
  <pre>DeviceProcessEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName has_any ("as-pc1","as-pc2","as-srv")
| where FileName =~ "schtasks.exe"
| where ProcessCommandLine has "/create"
| project Timestamp, DeviceName, AccountName, ProcessCommandLine
| order by Timestamp asc</pre>
</div></div>
<div class="kql">
<div class="kql-hd"><b>Q-S7b</b> — Backdoor local account creation</div>
<div class="kql-wrap">
  <div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceProcessEvents</span></div>
  <pre>DeviceProcessEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName has_any ("as-pc1","as-pc2","as-srv")
| where FileName in~ ("net.exe","net1.exe")
| where ProcessCommandLine has " user "
| where ProcessCommandLine has "/add"
| project Timestamp, DeviceName, AccountName, ProcessCommandLine
| order by Timestamp asc</pre>
</div></div>
</div>
</div>

<!-- SECTION S8: DATA ACCESS -->
<div class="section" id="s8">
<div class="section-header">
  <span class="sh-num">S8</span>
  <span class="sh-title">Data Access &amp; Exfiltration Preparation</span>
  <span class="sh-mitre">T1005 · T1039 · T1560.001 · T1083</span>
</div>
<div class="section-body">
<p class="p">On AS-SRV, the attacker navigated to <code>C:\Shares\Payroll\</code> and opened <code>BACS_Payments_Dec2025.ods</code> — a LibreOffice spreadsheet containing BACS (Bankers' Automated Clearing Services) payment records. BACS files typically contain employee or supplier bank account numbers, sort codes, and payment amounts. This is highly sensitive financial data with direct fraud potential.</p>
<p class="p"><strong>Proof of editing (not just viewing):</strong> When LibreOffice opens a document for editing, it immediately creates a lock file in the same directory with the naming pattern <code>.~lock.&lt;filename&gt;#</code>. This lock file exists ONLY while the document is actively open. A simple copy or view would never create this file. The presence of <code>.~lock.BACS_Payments_Dec2025.ods#</code> is therefore forensic proof that the document was opened and edited — not merely copied.</p>
<p class="p">Following data access, the attacker used Windows Explorer (explorer.exe via a Guacamole RDP session as AS.SRV.Administrator) to create <code>Shares.7z</code> — packaging the entire contents of the C:\Shares directory for exfiltration. The archive was staged within the shares directory itself before exfiltration.</p>
<div class="flags-grid">
  <div class="flag-card"><div class="flag-q">Sensitive Document</div><div class="flag-a">BACS_Payments_Dec2025.ods</div></div>
  <div class="flag-card"><div class="flag-q">Editing Proof Artifact</div><div class="flag-a sm">.~lock.BACS_Payments_Dec2025.ods#</div></div>
  <div class="flag-card"><div class="flag-q">Access Origin Host</div><div class="flag-a">AS-PC2</div></div>
  <div class="flag-card"><div class="flag-q">Exfil Archive</div><div class="flag-a">Shares.7z</div></div>
  <div class="flag-card"><div class="flag-q">Archive SHA256</div><div class="flag-a sm">6886c0a2e59792e69df94d2cf6ae62c2364fda50a23ab44317548895020ab048</div></div>
</div>
<div class="sub"><div class="sub-label">How Access Origin Was Determined</div>
<p class="p">The DeviceFileEvents query against AS-SRV showed <code>ntoskrnl.exe</code> (Windows kernel) as the initiating process for the BACS file access — this is normal behavior for SMB remote file access, where the kernel handles I/O on behalf of the remote session. The access origin was determined by correlating the <code>RequestAccountName</code> field which showed <strong>david.mitchell</strong> — the account associated with AS-PC2. This confirms AS-PC2 as the origin workstation.</p>
</div>
<div class="kql">
<div class="kql-hd"><b>Q-S8</b> — Full share activity on AS-SRV (data access + archive creation)</div>
<div class="kql-wrap">
  <div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceFileEvents</span></div>
  <pre>DeviceFileEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName =~ "as-srv"
| where FolderPath has @"C:\Shares"
| project Timestamp, ActionType, FolderPath, FileName, SHA256,
          InitiatingProcessFileName, InitiatingProcessAccountName,
          InitiatingProcessRemoteSessionDeviceName
| order by Timestamp asc</pre>
</div></div>
</div>
</div>

<!-- SECTION S9: ANTI-FORENSICS -->
<div class="section" id="s9">
<div class="section-header">
  <span class="sh-num">S9</span>
  <span class="sh-title">Anti-Forensics &amp; In-Memory Execution</span>
  <span class="sh-mitre">T1070.001 · T1620 · T1055.001 · T1555.003 · T1552.004</span>
</div>
<div class="section-body">
<p class="p">The attacker conducted two distinct anti-forensic operations: <strong>log clearing</strong> to degrade visibility into their actions, and <strong>reflective code loading</strong> to execute credential theft tooling without touching disk — making traditional file-based detection impossible.</p>
<div class="sub"><div class="sub-label">Log Clearing — wevtutil</div>
<p class="p">Four Windows event logs were cleared using <code>wevtutil.exe cl &lt;logname&gt;</code> — a built-in Windows utility for event log management. The Security log contains logon events, privilege use, account management — the most forensically valuable log for investigating what happened. The System log contains service starts/stops, driver loads. Application and Windows PowerShell logs were cleared to cover scripting activity. MDE telemetry still captured the clearing actions themselves, which is how we can enumerate what was cleared despite the logs being gone.</p>
<div class="tbl-outer"><table>
<thead><tr><th>Time (UTC)</th><th>Command</th><th>Log Cleared</th><th>Why It Matters</th></tr></thead>
<tbody>
<tr><td>08:07:59</td><td><code>wevtutil.exe cl Security</code></td><td>Security</td><td>Logon events, privilege escalation, account creation</td></tr>
<tr><td>08:08:00</td><td><code>wevtutil.exe cl System</code></td><td>System</td><td>Service creation, driver loads, system errors</td></tr>
<tr><td>08:08:01</td><td><code>wevtutil.exe cl Application</code></td><td>Application</td><td>Application errors, AnyDesk activity</td></tr>
<tr><td>08:08:09</td><td><code>wevtutil.exe cl "Windows PowerShell"</code></td><td>Windows PowerShell</td><td>PowerShell script execution history</td></tr>
</tbody>
</table></div></div>
<div class="sub"><div class="sub-label">SharpChrome — Reflective Code Loading into notepad.exe</div>
<p class="p">SharpChrome is a GhostPack tool written in C# (.NET) that targets browser credential stores. It was <strong>never written to disk</strong> — instead, it was injected directly into the memory of <code>notepad.exe</code> as a .NET assembly using reflective loading (T1620). The Windows CLR (Common Language Runtime) — the engine that executes .NET code — loaded SharpChrome entirely in memory. Since there is no file on disk, traditional AV/EDR file scanning cannot detect it.</p>
<p class="p">The execution sequence: <code>Daniel_Richardson_CV.pdf.exe</code> called <code>CreateRemoteThread()</code> in notepad.exe's process space, loading <code>System.ni.dll</code> (the compiled .NET framework library) and then SharpChrome as an unbacked CLR module. MDE detected this via the <code>ClrUnbackedModuleLoaded</code> ActionType — a specific detection for .NET assemblies loaded with no corresponding file on disk. SharpChrome then called <code>UnprotectData()</code> (Windows DPAPI) twice — once for Microsoft Edge credentials and once for Google Chrome credentials — decrypting saved passwords from the Chrome/Edge Login Data SQLite database.</p>
<div class="flags-grid">
  <div class="flag-card"><div class="flag-q">Cleared Logs (any two)</div><div class="flag-a">Security, System</div></div>
  <div class="flag-card"><div class="flag-q">Reflective Loading ActionType</div><div class="flag-a">ClrUnbackedModuleLoaded</div></div>
  <div class="flag-card"><div class="flag-q">In-Memory Tool</div><div class="flag-a">SharpChrome</div></div>
  <div class="flag-card"><div class="flag-q">Host Process</div><div class="flag-a">notepad.exe</div></div>
</div>
<div class="kql">
<div class="kql-hd"><b>Q-S9a</b> — Log clearing events (anti-forensics)</div>
<div class="kql-wrap">
  <div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceProcessEvents</span></div>
  <pre>DeviceProcessEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName has_any ("as-pc1","as-pc2","as-srv")
| where FileName =~ "wevtutil.exe"
| project Timestamp, DeviceName, AccountName, ProcessCommandLine
| order by Timestamp asc</pre>
</div></div>
<div class="kql">
<div class="kql-hd"><b>Q-S9b</b> — Reflective CLR module loading (SharpChrome) — the honest hunting approach</div>
<div class="kql-wrap">
  <div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceEvents</span></div>
  <pre>DeviceEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName == "as-pc1"
| where InitiatingProcessFileName =~ "notepad.exe"
| project Timestamp, ActionType, InitiatingProcessFileName,
          AdditionalFields
| order by Timestamp asc</pre>
</div></div>
<div class="sub"><div class="sub-label">Why DeviceEvents and Not DeviceProcessEvents?</div>
<p class="p">DeviceProcessEvents only captures new process creation. SharpChrome was never launched as a process — it was injected into an existing process (notepad.exe) as a .NET assembly in memory. DeviceEvents is MDE's catch-all table for security events that don't fit process/file/network categories — including CLR module loads, DPAPI calls, memory protection changes, and process injection indicators. The <code>ClrUnbackedModuleLoaded</code> ActionType specifically identifies .NET assemblies loaded into memory with no corresponding file path on disk — the exact signature of reflective loading.</p>
</div>
</div>
</div>

<!-- SECTION 10: IMPACT -->
<div class="section" id="impact">
<div class="section-header">
  <span class="sh-num">10</span>
  <span class="sh-title">Impact Assessment</span>
</div>
<div class="section-body">
<div class="impact-wrap">
  <div class="impact-row conf"><span class="ibadge conf">Confidentiality</span><span><strong>BACS payment data accessed and archived.</strong> BACS_Payments_Dec2025.ods contains employee/supplier banking details (account numbers, sort codes, payment amounts). Direct fraud potential if exfiltrated to threat actor.</span></div>
  <div class="impact-row conf"><span class="ibadge conf">Confidentiality</span><span><strong>Browser credentials stolen via SharpChrome/DPAPI.</strong> All saved passwords in Microsoft Edge and Google Chrome on AS-PC1 were decrypted and exfiltrated in plaintext — internal systems, email, banking portals, SaaS applications.</span></div>
  <div class="impact-row conf"><span class="ibadge conf">Confidentiality</span><span><strong>NTLM hashes dumped from registry.</strong> SAM + SYSTEM hives staged at C:\Users\Public\ — local account hashes available for offline cracking or Pass-the-Hash attacks against internal systems.</span></div>
  <div class="impact-row conf"><span class="ibadge conf">Confidentiality</span><span><strong>Entire Shares directory archived (Shares.7z).</strong> All data across C:\Shares\ — Payroll, Clients, Contractors — packaged for exfiltration. Full organizational data exposure likely.</span></div>
  <div class="impact-row risk"><span class="ibadge risk">Persistence</span><span><strong>AnyDesk deployed on all 3 hosts with known password.</strong> Unattended access active with password <code>intrud3r!</code> — provides persistent GUI-level access independent of malware C2.</span></div>
  <div class="impact-row risk"><span class="ibadge risk">Persistence</span><span><strong>Scheduled task MicrosoftEdgeUpdateCheck on AS-PC2 and AS-SRV.</strong> Daily execution at 03:00 of RuntimeBroker.exe (malware) with highest privileges. Survives reboots.</span></div>
  <div class="impact-row pers"><span class="ibadge pers">Persistence</span><span><strong>Backdoor account svc_backup created on AS-PC1</strong> with Administrators membership. Provides credential-based access that persists even if AnyDesk is uninstalled and scheduled tasks are removed.</span></div>
  <div class="impact-row risk"><span class="ibadge risk">Integrity</span><span><strong>Built-in Administrator account activated on AS-PC2.</strong> <code>net user Administrator /active:yes</code> — re-enables a high-value account that is typically disabled in hardened environments.</span></div>
  <div class="impact-row risk"><span class="ibadge risk">Availability</span><span><strong>Four event logs cleared.</strong> Security, System, Application, Windows PowerShell — forensic visibility significantly degraded. Scope of compromise may be underestimated.</span></div>
</div>
<div class="risk critical" style="margin-top:14px;">
  <span class="risk-lbl">Critical</span>
  <span><strong>Estimated blast radius: all three AS domain hosts, full share content, credential material for browser-stored accounts, local NTLM hashes, and active persistent access channels (AnyDesk + scheduled task + backdoor account).</strong> The attacker has multiple redundant access paths. Remediation must address all simultaneously or the attacker will re-enter through whichever path was missed.</span>
</div>
</div>
</div>

<!-- SECTION 11: THREAT INTEL -->
<div class="section" id="intel">
<div class="section-header">
  <span class="sh-num">11</span>
  <span class="sh-title">Threat Intelligence Context</span>
</div>
<div class="section-body">
<div class="sub"><div class="sub-label">Initial Access Broker (IAB) Profile</div>
<p class="p">The tradecraft observed in this intrusion is highly consistent with <strong>Initial Access Broker</strong> operations. IABs are a specialized criminal ecosystem that emerged prominently around 2019–2020. Rather than conducting full ransomware attacks themselves, they specialize in gaining initial entry, establishing persistent access across the victim's environment, and then selling that access on dark web forums — typically for $500–$50,000 depending on organization size and access level.</p>
<p class="p">Key IAB indicators observed in this incident: (1) Multiple remote access channels established (AnyDesk on all hosts + C2 malware + scheduled task) — IABs establish redundancy to maximize sale value. (2) Credential harvesting scope (browser passwords, SAM hives) — credentials are bundled with access to increase sale price. (3) Financial data targeting (BACS payroll file) — confirms attacker understood the high value of this data. (4) Clean operational tempo with minimal dwell time — IABs are efficient to avoid detection before completing the access package.</p>
<div class="sub"><div class="sub-label">Tool Association — GhostPack / SharpCollection</div>
<p class="p">SharpChrome is part of the <strong>GhostPack</strong> offensive security toolkit maintained by SpecterOps. The use of reflective loading to inject C# tools into legitimate processes (notepad.exe, explorer.exe) is a signature tradecraft of groups using the SharpCollection ecosystem. This technique is heavily associated with post-exploitation frameworks like Cobalt Strike and Sliver, suggesting the malware may be a custom loader for a commercial C2 framework.</p>
</div>
</div>
</div>
</div>

<!-- SECTION 12: IOC SUMMARY -->
<div class="section" id="ioc">
<div class="section-header">
  <span class="sh-num">12</span>
  <span class="sh-title">IOC Summary</span>
</div>
<div class="section-body">
<div class="sub"><div class="sub-label">File Hashes</div>
<p class="p">
<span class="ioc hash">48b97fd91946e81e3e7742b3554585360551551cbf9398e1f34f4bc4eac3a6b5</span> — Daniel_Richardson_CV.pdf.exe / RuntimeBroker.exe (same payload)<br>
<span class="ioc hash">f42b635d93720d1624c74121b83794d706d4d064bee027650698025703d20532</span> — AnyDesk.exe<br>
<span class="ioc hash">6886c0a2e59792e69df94d2cf6ae62c2364fda50a23ab44317548895020ab048</span> — Shares.7z (exfil archive)
</p></div>
<div class="sub"><div class="sub-label">Domains</div>
<p class="p">
<span class="ioc red">cdn.cloud-endpoint.net</span> — C2 domain<br>
<span class="ioc red">sync.cloud-endpoint.net</span> — Staging / payload hosting domain
</p></div>
<div class="sub"><div class="sub-label">Accounts Created by Attacker</div>
<p class="p">
<span class="ioc red">svc_backup</span> — Backdoor local admin account on AS-PC1
</p></div>
<div class="sub"><div class="sub-label">Scheduled Tasks Created by Attacker</div>
<p class="p">
<span class="ioc red">MicrosoftEdgeUpdateCheck</span> — on AS-PC2 and AS-SRV, executing C:\Users\Public\RuntimeBroker.exe daily at 03:00
</p></div>
<div class="sub"><div class="sub-label">Files of Interest</div>
<p class="p">
<span class="ioc">C:\Users\Public\sam.hiv</span><br>
<span class="ioc">C:\Users\Public\system.hiv</span><br>
<span class="ioc">C:\Users\Public\AnyDesk.exe</span><br>
<span class="ioc">C:\Users\Public\RuntimeBroker.exe</span><br>
<span class="ioc">C:\Shares\Clients\Shares.7z</span>
</p></div>
<div class="sub"><div class="sub-label">Unattended Access Credential</div>
<p class="p"><span class="ioc red">intrud3r!</span> — AnyDesk unattended password set on all three hosts via --set-password</p></div>
</div>
</div>

<!-- SECTION 13: RECOMMENDATIONS -->
<div class="section" id="recs">
<div class="section-header">
  <span class="sh-num">13</span>
  <span class="sh-title">Recommendations</span>
</div>
<div class="section-body">
<div class="rec-grp">
  <span class="rec-badge rb-now">Immediate — Now</span>
  <ul class="bl">
    <li><strong>Isolate AS-PC1, AS-PC2, AS-SRV immediately</strong> from the network. All three hosts have active persistent access channels. Network isolation prevents the attacker from using any of them while remediation proceeds.</li>
    <li><strong>Uninstall AnyDesk from all three hosts</strong> and revoke any AnyDesk IDs associated with them. The password <code>intrud3r!</code> must be considered burned across all AnyDesk installations in the organization.</li>
    <li><strong>Delete scheduled task MicrosoftEdgeUpdateCheck</strong> on AS-PC2 and AS-SRV. Delete RuntimeBroker.exe from C:\Users\Public\ on both hosts.</li>
    <li><strong>Disable and delete svc_backup account</strong> on AS-PC1. Audit all local accounts on all three hosts for other attacker-created accounts.</li>
    <li><strong>Re-disable the built-in Administrator account</strong> on AS-PC2. Rotate the Administrator password on all three hosts.</li>
    <li><strong>Delete sam.hiv and system.hiv</strong> from C:\Users\Public\ on AS-PC1. Consider all local account passwords on AS-PC1 compromised — rotate immediately.</li>
    <li><strong>Force password reset for Sophie.Turner and David.Mitchell</strong> domain accounts. All browser-saved passwords on AS-PC1 must be considered compromised — notify affected users to reset credentials on all sites stored in Chrome/Edge.</li>
    <li><strong>Block C2/staging domains at perimeter firewall and DNS:</strong> cdn.cloud-endpoint.net, sync.cloud-endpoint.net.</li>
  </ul>
</div>
<div class="rec-grp">
  <span class="rec-badge rb-short">Short-Term — This Week</span>
  <ul class="bl">
    <li><strong>Forensic imaging</strong> of all three hosts before reimaging. Preserve memory dumps if possible — SharpChrome output may still be recoverable from memory.</li>
    <li><strong>Hunt for additional compromised hosts.</strong> Query DeviceNetworkEvents for any hosts that connected to cdn.cloud-endpoint.net or sync.cloud-endpoint.net. Run SHA256 hash <code>48b97fd...</code> across the entire estate.</li>
    <li><strong>Notify relevant parties about BACS data exposure.</strong> If BACS_Payments_Dec2025.ods was exfiltrated, financial institutions and affected employees/suppliers may need to be notified per applicable data protection regulations.</li>
    <li><strong>Block certutil.exe outbound internet access</strong> via firewall rules. Certutil has no legitimate reason to download files from external domains in most enterprise environments.</li>
    <li><strong>Audit all AnyDesk installations</strong> across the organization. AnyDesk should be allowlisted only for approved business use and managed centrally.</li>
    <li><strong>Enable Windows Defender Attack Surface Reduction (ASR) rules</strong> to block process injection, prevent credential dumping, and restrict Office/browser processes from spawning child processes.</li>
  </ul>
</div>
<div class="rec-grp">
  <span class="rec-badge rb-long">Long-Term — Strategic</span>
  <ul class="bl">
    <li><strong>Deploy email attachment sandboxing</strong> that detonates executable files disguised with double extensions before delivery. The initial vector was a .exe masquerading as a PDF — basic attachment analysis would have caught this.</li>
    <li><strong>Enable file extension visibility</strong> in Windows Explorer for all user endpoints (disabled by default). Users cannot identify double-extension attacks when extensions are hidden.</li>
    <li><strong>Implement Privileged Access Workstations (PAW)</strong> for accounts with administrative access to AS-SRV. The Payroll share should not be directly accessible from standard user workstations.</li>
    <li><strong>Deploy EDR with memory scanning capabilities.</strong> ClrUnbackedModuleLoaded events should trigger immediate alert escalation — notepad.exe loading CLR modules is never legitimate.</li>
    <li><strong>Implement network segmentation</strong> to prevent direct RDP access between workstations and the file server. Lateral movement via mstsc should require explicit jump server routing through a PAM solution.</li>
    <li><strong>Enable PowerShell Constrained Language Mode and Script Block Logging</strong> on all endpoints. This would have preserved PowerShell activity even after log clearing.</li>
    <li><strong>User security awareness training</strong> focused on double-extension attacks, CV-themed lures, and the risks of executing files from email/downloads without verification.</li>
  </ul>
</div>
</div>
</div>

<!-- SECTION 14: KQL LIBRARY -->
<div class="section" id="kql">
<div class="section-header">
  <span class="sh-num">14</span>
  <span class="sh-title">Full KQL Query Library</span>
</div>
<div class="section-body">
<p class="p">All queries are scoped to the attack window and the three compromised hosts. Run in Microsoft Sentinel (Logs blade) or MDE Advanced Hunting.</p>

<div class="kql"><div class="kql-hd"><b>Q01</b> — Scope variables (reuse across queries)</div>
<div class="kql-wrap"><div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL</span></div>
<pre>let Start   = datetime(2026-01-15 00:00:00);
let End     = datetime(2026-01-15 23:59:59);
let Devices = dynamic(["as-pc1","as-pc2","as-srv"]);</pre>
</div></div>

<div class="kql"><div class="kql-hd"><b>Q02</b> — Initial access vector — SHA256 and process chain</div>
<div class="kql-wrap"><div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceProcessEvents</span></div>
<pre>DeviceProcessEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName == "as-pc1"
| where FileName =~ "Daniel_Richardson_CV.pdf.exe"
| project Timestamp, FileName, SHA256, FolderPath,
          InitiatingProcessFileName, ProcessCommandLine</pre>
</div></div>

<div class="kql"><div class="kql-hd"><b>Q03</b> — C2 connections initiated by malware</div>
<div class="kql-wrap"><div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceNetworkEvents</span></div>
<pre>DeviceNetworkEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName == "as-pc1"
| where InitiatingProcessFileName =~ "Daniel_Richardson_CV.pdf.exe"
| project Timestamp, RemoteUrl, RemoteIP, RemotePort,
          InitiatingProcessFileName
| order by Timestamp asc</pre>
</div></div>

<div class="kql"><div class="kql-hd"><b>Q04</b> — Registry hive dumping (credential access)</div>
<div class="kql-wrap"><div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceProcessEvents</span></div>
<pre>DeviceProcessEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName has_any ("as-pc1","as-pc2","as-srv")
| where FileName =~ "reg.exe"
| where ProcessCommandLine has_any ("save","HKLM")
| project Timestamp, DeviceName, AccountName, ProcessCommandLine
| order by Timestamp asc</pre>
</div></div>

<div class="kql"><div class="kql-hd"><b>Q05</b> — Discovery commands</div>
<div class="kql-wrap"><div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceProcessEvents</span></div>
<pre>DeviceProcessEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName has_any ("as-pc1","as-pc2","as-srv")
| where FileName in~ ("whoami.exe","net.exe","ipconfig.exe","hostname.exe","arp.exe")
| project Timestamp, DeviceName, AccountName, FileName, ProcessCommandLine
| order by Timestamp asc</pre>
</div></div>

<div class="kql"><div class="kql-hd"><b>Q06</b> — AnyDesk deployment (file creation across all hosts)</div>
<div class="kql-wrap"><div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceFileEvents</span></div>
<pre>DeviceFileEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName has_any ("as-pc1","as-pc2","as-srv")
| where InitiatingProcessFileName =~ "AnyDesk.exe"
| project Timestamp, DeviceName, ActionType, FolderPath,
          FileName, InitiatingProcessAccountName
| order by Timestamp asc</pre>
</div></div>

<div class="kql"><div class="kql-hd"><b>Q07</b> — certutil download activity (LOLBIN abuse)</div>
<div class="kql-wrap"><div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceProcessEvents</span></div>
<pre>DeviceProcessEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName has_any ("as-pc1","as-pc2","as-srv")
| where FileName =~ "certutil.exe"
| where ProcessCommandLine has_any ("urlcache","http","download")
| project Timestamp, DeviceName, AccountName, ProcessCommandLine
| order by Timestamp asc</pre>
</div></div>

<div class="kql"><div class="kql-hd"><b>Q08</b> — All remote execution tool attempts (lateral movement hunt)</div>
<div class="kql-wrap"><div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceProcessEvents</span></div>
<pre>DeviceProcessEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName has_any ("as-pc1","as-pc2","as-srv")
| where FileName in~ ("psexec.exe","wmic.exe","winrs.exe","mstsc.exe",
                      "schtasks.exe","sc.exe","at.exe","net.exe")
| where ProcessCommandLine has_any ("\\\\","/node:","/v:","computername","/r:")
| project Timestamp, DeviceName, AccountName, FileName, ProcessCommandLine
| order by Timestamp asc</pre>
</div></div>

<div class="kql"><div class="kql-hd"><b>Q09</b> — Scheduled task creation (persistence)</div>
<div class="kql-wrap"><div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceProcessEvents</span></div>
<pre>DeviceProcessEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName has_any ("as-pc1","as-pc2","as-srv")
| where FileName =~ "schtasks.exe"
| where ProcessCommandLine has "/create"
| project Timestamp, DeviceName, AccountName, ProcessCommandLine
| order by Timestamp asc</pre>
</div></div>

<div class="kql"><div class="kql-hd"><b>Q10</b> — Backdoor account creation</div>
<div class="kql-wrap"><div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceProcessEvents</span></div>
<pre>DeviceProcessEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName has_any ("as-pc1","as-pc2","as-srv")
| where FileName in~ ("net.exe","net1.exe")
| where ProcessCommandLine has " user " and ProcessCommandLine has "/add"
| project Timestamp, DeviceName, AccountName, ProcessCommandLine
| order by Timestamp asc</pre>
</div></div>

<div class="kql"><div class="kql-hd"><b>Q11</b> — File share access and exfil archive on AS-SRV</div>
<div class="kql-wrap"><div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceFileEvents</span></div>
<pre>DeviceFileEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName =~ "as-srv"
| where FolderPath has @"C:\Shares"
| project Timestamp, ActionType, FolderPath, FileName, SHA256,
          InitiatingProcessFileName, InitiatingProcessAccountName,
          InitiatingProcessRemoteSessionDeviceName
| order by Timestamp asc</pre>
</div></div>

<div class="kql"><div class="kql-hd"><b>Q12</b> — Event log clearing (anti-forensics)</div>
<div class="kql-wrap"><div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceProcessEvents</span></div>
<pre>DeviceProcessEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName has_any ("as-pc1","as-pc2","as-srv")
| where FileName =~ "wevtutil.exe"
| project Timestamp, DeviceName, AccountName, ProcessCommandLine
| order by Timestamp asc</pre>
</div></div>

<div class="kql"><div class="kql-hd"><b>Q13</b> — SharpChrome reflective loading detection (in-memory tool)</div>
<div class="kql-wrap"><div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceEvents</span></div>
<pre>DeviceEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName == "as-pc1"
| where InitiatingProcessFileName =~ "notepad.exe"
| project Timestamp, ActionType, InitiatingProcessFileName, AdditionalFields
| order by Timestamp asc</pre>
</div></div>

<div class="kql"><div class="kql-hd"><b>Q14</b> — Full wide process scan (initial triage baseline)</div>
<div class="kql-wrap"><div class="kql-bar"><div class="kql-dots"><i></i><i></i><i></i></div><span class="kql-tag">KQL · DeviceProcessEvents</span></div>
<pre>DeviceProcessEvents
| where Timestamp between (datetime(2026-01-15) .. datetime(2026-01-16))
| where DeviceName has_any ("as-pc1","as-pc2","as-srv")
| project Timestamp, DeviceName, AccountName, FileName,
          ProcessCommandLine, InitiatingProcessFileName,
          InitiatingProcessCommandLine, SHA256
| order by Timestamp asc</pre>
</div></div>

</div>
</div>

<!-- FOOTER -->
<div class="foot">
  <span class="foot-conf">CONFIDENTIAL</span>
  <span>Ashford Sterling Recruitment — BROKER-001 &nbsp;·&nbsp; Yousef Nabil &nbsp;·&nbsp; February 25, 2026</span>
</div>

</main>
</div>

<script>
(function(){
  const links = document.querySelectorAll('.nav-link');
  const ids   = Array.from(links).map(l=>l.getAttribute('href').slice(1));
  const els   = ids.map(id=>document.getElementById(id)).filter(Boolean);
  function tick(){
    const y  = window.scrollY + 80;
    let cur  = els[0];
    for(const e of els){ if(e && e.offsetTop<=y) cur=e; }
    links.forEach(l=>l.classList.toggle('active', cur && l.getAttribute('href')==='#'+cur.id));
  }
  window.addEventListener('scroll', tick, {passive:true});
  tick();
})();
</script>

</body>
</html>
